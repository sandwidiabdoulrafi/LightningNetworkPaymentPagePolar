'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _base64url = require('base64url');

var _base64url2 = _interopRequireDefault(_base64url);

var _strictUriEncode = require('strict-uri-encode');

var _strictUriEncode2 = _interopRequireDefault(_strictUriEncode);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Encode a binary macaroon as a base64 encoded url string.
 * @param  {String} macaroonPath Path to macaroon file.
 * @return {String} Encoded macaroon
 */
const encodeMacaroon = (input, format = 'hex') => {
  if (!input) {
    return '';
  }

  // If we have a string, which does not look like hex treat it as a file path.
  if (typeof input === 'string' && !/^[0-9a-fA-F]+$/.test(input)) {
    return (0, _strictUriEncode2.default)(input);
  }

  // Otherwise, base64url encode it.
  const macaroonBase64 = new Buffer.from(input, format).toString('base64');
  return _base64url2.default.fromBase64(macaroonBase64);
};

exports.default = encodeMacaroon;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbmNvZGVNYWNhcm9vbi5qcyJdLCJuYW1lcyI6WyJlbmNvZGVNYWNhcm9vbiIsImlucHV0IiwiZm9ybWF0IiwidGVzdCIsIm1hY2Fyb29uQmFzZTY0IiwiQnVmZmVyIiwiZnJvbSIsInRvU3RyaW5nIiwiYmFzZTY0dXJsIiwiZnJvbUJhc2U2NCJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7Ozs7QUFDQTs7Ozs7O0FBRUE7Ozs7O0FBS0EsTUFBTUEsaUJBQWlCLENBQUNDLEtBQUQsRUFBUUMsU0FBUyxLQUFqQixLQUEyQjtBQUNoRCxNQUFJLENBQUNELEtBQUwsRUFBWTtBQUNWLFdBQU8sRUFBUDtBQUNEOztBQUVEO0FBQ0EsTUFBSSxPQUFPQSxLQUFQLEtBQWlCLFFBQWpCLElBQTZCLENBQUMsaUJBQWlCRSxJQUFqQixDQUFzQkYsS0FBdEIsQ0FBbEMsRUFBZ0U7QUFDOUQsV0FBTywrQkFBZ0JBLEtBQWhCLENBQVA7QUFDRDs7QUFFRDtBQUNBLFFBQU1HLGlCQUFpQixJQUFJQyxPQUFPQyxJQUFYLENBQWdCTCxLQUFoQixFQUF1QkMsTUFBdkIsRUFBK0JLLFFBQS9CLENBQXdDLFFBQXhDLENBQXZCO0FBQ0EsU0FBT0Msb0JBQVVDLFVBQVYsQ0FBcUJMLGNBQXJCLENBQVA7QUFDRCxDQWJEOztrQkFlZUosYyIsImZpbGUiOiJlbmNvZGVNYWNhcm9vbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBiYXNlNjR1cmwgZnJvbSAnYmFzZTY0dXJsJ1xuaW1wb3J0IHN0cmljdFVyaUVuY29kZSBmcm9tICdzdHJpY3QtdXJpLWVuY29kZSdcblxuLyoqXG4gKiBFbmNvZGUgYSBiaW5hcnkgbWFjYXJvb24gYXMgYSBiYXNlNjQgZW5jb2RlZCB1cmwgc3RyaW5nLlxuICogQHBhcmFtICB7U3RyaW5nfSBtYWNhcm9vblBhdGggUGF0aCB0byBtYWNhcm9vbiBmaWxlLlxuICogQHJldHVybiB7U3RyaW5nfSBFbmNvZGVkIG1hY2Fyb29uXG4gKi9cbmNvbnN0IGVuY29kZU1hY2Fyb29uID0gKGlucHV0LCBmb3JtYXQgPSAnaGV4JykgPT4ge1xuICBpZiAoIWlucHV0KSB7XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICAvLyBJZiB3ZSBoYXZlIGEgc3RyaW5nLCB3aGljaCBkb2VzIG5vdCBsb29rIGxpa2UgaGV4IHRyZWF0IGl0IGFzIGEgZmlsZSBwYXRoLlxuICBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJyAmJiAhL15bMC05YS1mQS1GXSskLy50ZXN0KGlucHV0KSkge1xuICAgIHJldHVybiBzdHJpY3RVcmlFbmNvZGUoaW5wdXQpXG4gIH1cblxuICAvLyBPdGhlcndpc2UsIGJhc2U2NHVybCBlbmNvZGUgaXQuXG4gIGNvbnN0IG1hY2Fyb29uQmFzZTY0ID0gbmV3IEJ1ZmZlci5mcm9tKGlucHV0LCBmb3JtYXQpLnRvU3RyaW5nKCdiYXNlNjQnKVxuICByZXR1cm4gYmFzZTY0dXJsLmZyb21CYXNlNjQobWFjYXJvb25CYXNlNjQpXG59XG5cbmV4cG9ydCBkZWZhdWx0IGVuY29kZU1hY2Fyb29uXG4iXX0=